var diffview={buildView:function(e){function t(e,t){var n=document.createElement(e);return n.className=t,n}function n(e,t){var n=document.createElement(e);return n.appendChild(document.createTextNode(t)),n}function d(e,t,n){var d=document.createElement(e);return d.className=t,d.appendChild(document.createTextNode(n)),d}function a(e,a,i,l,h){return a<i?(e.appendChild(n("th",(a+1).toString())),e.appendChild(d("td",h,l[a].replace(/\t/g,"    "))),a+1):(e.appendChild(document.createElement("th")),e.appendChild(t("td","empty")),a)}function i(e,t,a,i,l){e.appendChild(n("th",null==t?"":(t+1).toString())),e.appendChild(n("th",null==a?"":(a+1).toString())),e.appendChild(d("td",l,i[null!=t?t:a].replace(/\t/g,"    ")))}var l=e.baseTextLines,h=e.newTextLines,p=e.opcodes,r=e.baseTextName?e.baseTextName:"Base Text",c=e.newTextName?e.newTextName:"New Text",o=e.contextSize,u=0==e.viewType||1==e.viewType?e.viewType:0;if(null==l)throw"Cannot build diff view; baseTextLines is not defined.";if(null==h)throw"Cannot build diff view; newTextLines is not defined.";if(!p)throw"Canno build diff view; opcodes is not defined.";var f=document.createElement("thead"),m=document.createElement("tr");f.appendChild(m),u?(m.appendChild(document.createElement("th")),m.appendChild(document.createElement("th")),m.appendChild(d("th","texttitle",r+" vs. "+c))):(m.appendChild(document.createElement("th")),m.appendChild(d("th","texttitle",r)),m.appendChild(document.createElement("th")),m.appendChild(d("th","texttitle",c))),f=[f];for(var s,C=[],g=0;g<p.length;g++){code=p[g],change=code[0];for(var v=code[1],w=code[2],b=code[3],x=code[4],T=Math.max(w-v,x-b),E=[],N=[],y=0;y<T;y++){if(o&&p.length>1&&(g>0&&y==o||0==g&&0==y)&&"equal"==change){var k=T-(0==g?1:2)*o;if(k>1){if(E.push(m=document.createElement("tr")),v+=k,b+=k,y+=k-1,m.appendChild(n("th","...")),u||m.appendChild(d("td","skip","")),m.appendChild(n("th","...")),m.appendChild(d("td","skip","")),g+1==p.length)break;continue}}E.push(m=document.createElement("tr")),u?"insert"==change?i(m,null,b++,h,change):"replace"==change?(N.push(s=document.createElement("tr")),v<w&&i(m,v++,null,l,"delete"),b<x&&i(s,null,b++,h,"insert")):"delete"==change?i(m,v++,null,l,change):i(m,v++,b++,l,change):(v=a(m,v,w,l,change),b=a(m,b,x,h,change))}for(y=0;y<E.length;y++)C.push(E[y]);for(y=0;y<N.length;y++)C.push(N[y])}C.push(m=d("th","author","diff view generated by ")),m.setAttribute("colspan",u?3:4),m.appendChild(s=n("a","jsdifflib")),s.setAttribute("href","http://github.com/cemerick/jsdifflib"),f.push(m=document.createElement("tbody"));for(var g in C)C.hasOwnProperty(g)&&m.appendChild(C[g]);m=t("table","diff"+(u?" inlinediff":""));for(var g in f)f.hasOwnProperty(g)&&m.appendChild(f[g]);return m}};
